# Порядок загрузки и работы #

# I. Загрузка #

1. ClassLoader загружает
  1.1. Bootstrap ClassLoader загружает классы String, Object, System, Integer;
  1.2. Application ClassLoader загружает класс JvmComprehension.
  
2. Связывание

3. Инициализация

Результат: классы String, Object, System, Integer, JvmComprehension корректно размещены в Metaspace.

# II. Работа #

1. На стеке создается фрейм метода main
2. В куче создается объект String[], на стеке создается ссылка args на этот объект
3. На стеке размещается переменная i, устанавливается значение = 1 // 1
4. В куче создается объект класса Object, на стеке создается ссылка o на этот объект // 2
5. В куче создается объект класса Integer, которому устанавливается значение 2; на стеке создается ссылка ii на этот объект // 3
6. Выполняется метод printAll // 4

   6.0. На стеке создается фрейм метода printAll
   
   6.1. На стеке создается ссылка о, значение - ссылка на объект o из метода main
   
   6.2. На стеке создается переменная i, значение копируется из переменной i метода main
   
   6.3. На стеке создается ссылка ii, значение - ссылка на объект ii из метода main
   
   6.4. В куче создается объект класса Integer, которому устанавливается значение 700; на стеке создается ссылка ii на этот объект // 5
   
   6.5. Выполняется расчет выражения o.toString() + i + ii // 6
      - в результате в куче появляется объект класса String с расчитанным значением, а на стеке появляется неименованная ссылка на этот объект
      
   6.6. Выполняется метод System.out.println
      - на стеке создается фрейм метода System.out.println
      - на стеке создается ссылка на объект String из шага 6.5
      - выполняется печать
      - со стека удаляется фрейм метода System.out.println
      
   6.7. Со стека удаляется фрейм метода printAll

7. В куче создается объект класса String со значением "finished", а на стеке появляется неименованная ссылка на этот объект
8. Выполняется метод System.out.println
     - на стеке создается фрейм метода System.out.println
     - на стеке создается ссылка на объект String из шага 7
     - выполняется печать
     - со стека удаляется фрейм метода System.out.println
9. Со стека удаляется фрейм метода main.


# III. Сборка мусора #


Если для простоты предположить, что сборка мусора выполняется после каждого удаления фрейма (завершения метода), то

1. После удаления фреймов System.out.println - будут собраны в мусор строки, которые были переданы в этот метод на печать.
2. После удаления фрейма printAll будет собран в мусор объект uselessVar
3. После удаления фрейма main будут собраны в мусор объекты o, ii
4. Объект args будет удален не сборщиком мусора, а при завершении всей программы и выгрузке ее из памяти.

